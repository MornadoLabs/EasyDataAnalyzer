import { Chart } from "chart.js";
var EasyDataAnalyzer;
(function (EasyDataAnalyzer) {
    var Analysis;
    (function (Analysis) {
        var Results;
        (function (Results) {
            class DatasetModel {
                constructor(data, showLine, showPoint) {
                    let bgColor = [];
                    let brdColor = [];
                    data.forEach((i) => {
                        bgColor.push('rgba(255, 99, 132, 0.2)');
                        brdColor.push('rgba(255, 99, 132, 1)');
                    });
                    this.showLine = showLine;
                    this.fill = false;
                    this.tension = 0;
                    this.data = data;
                    this.backgroundColor = bgColor;
                    this.borderColor = brdColor;
                    this.borderWidth = 2;
                    this.pointRadius = showPoint ? 5 : 0;
                }
            }
            Results.DatasetModel = DatasetModel;
            class RegressionService {
                constructor() {
                    this.ElementIDs = {
                        YToXChart: "YToXChart",
                        XToYChart: "XToYChart",
                    };
                    this.Urls = {
                        LoadCharts: "LoadCharts",
                    };
                    this.initialize();
                }
                initialize() {
                    let self = this;
                    let YToXCanvas = document.getElementById(self.ElementIDs.YToXChart);
                    let XToYCanvas = document.getElementById(self.ElementIDs.XToYChart);
                    let YToXContext = YToXCanvas.getContext("2d");
                    let XToYContext = XToYCanvas.getContext("2d");
                    $.ajax({
                        url: self.Urls.LoadCharts,
                        async: false,
                        method: "GET",
                        success: (response) => {
                            let data = response.analysisData;
                            let chartData = response.ytoX;
                            let YToXChart = self.initializeChart(YToXContext, data, response.ytoX, response.xLabel, response.yLabel);
                            let reversedData = [];
                            let reversedChart = [];
                            data.forEach((e, i) => {
                                reversedData.push({ x: e.y, y: e.x, r: e.r, t: e.t });
                            });
                            chartData.forEach((e, i) => {
                                reversedChart.push({ x: e.y, y: e.x, r: e.r, t: e.t });
                            });
                            let XToYChart = self.initializeChart(XToYContext, reversedData, reversedChart, response.yLabel, response.xLabel);
                        }
                    });
                }
                initializeChart(context, points, resultChart, axesXLable, axesYLabel) {
                    let datasets = [];
                    datasets.push(new DatasetModel(resultChart, true, false));
                    datasets.push(new DatasetModel(points, false, true));
                    let minX = points[0].x, minY = points[0].y, maxX = points[0].x, maxY = points[0].y;
                    for (let i = 1; i < points.length; i++) {
                        if (points[i].x < minX) {
                            minX = points[i].x;
                        }
                        if (points[i].x > maxX) {
                            maxX = points[i].x;
                        }
                        if (points[i].y < minY) {
                            minY = points[i].y;
                        }
                        if (points[i].y > maxY) {
                            maxY = points[i].y;
                        }
                    }
                    let chart = new Chart(context, {
                        type: 'scatter',
                        data: {
                            datasets: datasets,
                        },
                        options: {
                            legend: {
                                display: false
                            },
                            scales: {
                                xAxes: [{
                                        position: 'bottom',
                                        type: 'linear',
                                        gridLines: {
                                            display: false
                                        },
                                        ticks: {
                                            min: minX - 10,
                                            max: maxX + 10
                                        },
                                        scaleLabel: {
                                            display: true,
                                            labelString: axesXLable,
                                            fontSize: 16,
                                            fontStyle: 'bold'
                                        }
                                    }],
                                yAxes: [{
                                        ticks: {
                                            min: minY - 10,
                                            max: maxY + 10
                                        },
                                        scaleLabel: {
                                            display: true,
                                            labelString: axesYLabel,
                                            fontSize: 16,
                                            fontStyle: 'bold'
                                        }
                                    }]
                            },
                        }
                    });
                    return chart;
                }
            }
            Results.regressionResults = new RegressionService();
        })(Results = Analysis.Results || (Analysis.Results = {}));
    })(Analysis = EasyDataAnalyzer.Analysis || (EasyDataAnalyzer.Analysis = {}));
})(EasyDataAnalyzer || (EasyDataAnalyzer = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVncmVzc2lvblJlc3VsdHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9TY3JpcHRzL3JlZ3Jlc3Npb25SZXN1bHRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBYyxLQUFLLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFFN0MsSUFBVSxnQkFBZ0IsQ0F1SnpCO0FBdkpELFdBQVUsZ0JBQWdCO0lBQUMsSUFBQSxRQUFRLENBdUpsQztJQXZKMEIsV0FBQSxRQUFRO1FBQUMsSUFBQSxPQUFPLENBdUoxQztRQXZKbUMsV0FBQSxPQUFPO1lBRXZDLE1BQWEsWUFBWTtnQkFDckIsWUFBWSxJQUFrQixFQUFFLFFBQWlCLEVBQUUsU0FBa0I7b0JBQ2pFLElBQUksT0FBTyxHQUFhLEVBQUUsQ0FBQztvQkFDM0IsSUFBSSxRQUFRLEdBQWEsRUFBRSxDQUFDO29CQUU1QixJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUU7d0JBQ2YsT0FBTyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO3dCQUN4QyxRQUFRLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7b0JBQzNDLENBQUMsQ0FBQyxDQUFDO29CQUVILElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO29CQUN6QixJQUFJLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQztvQkFDbEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUM7b0JBQ2pCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO29CQUNqQixJQUFJLENBQUMsZUFBZSxHQUFHLE9BQU8sQ0FBQztvQkFDL0IsSUFBSSxDQUFDLFdBQVcsR0FBRyxRQUFRLENBQUM7b0JBQzVCLElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDO29CQUNyQixJQUFJLENBQUMsV0FBVyxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFD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Q29udGVudCI6WyJpbXBvcnQgeyBDaGFydFBvaW50LCBDaGFydCB9IGZyb20gXCJjaGFydC5qc1wiO1xyXG5cclxubmFtZXNwYWNlIEVhc3lEYXRhQW5hbHl6ZXIuQW5hbHlzaXMuUmVzdWx0cyB7XHJcblxyXG4gICAgZXhwb3J0IGNsYXNzIERhdGFzZXRNb2RlbCB7XHJcbiAgICAgICAgY29uc3RydWN0b3IoZGF0YTogQ2hhcnRQb2ludFtdLCBzaG93TGluZTogYm9vbGVhbiwgc2hvd1BvaW50OiBib29sZWFuKSB7XHJcbiAgICAgICAgICAgIGxldCBiZ0NvbG9yOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgYnJkQ29sb3I6IHN0cmluZ1tdID0gW107XHJcblxyXG4gICAgICAgICAgICBkYXRhLmZvckVhY2goKGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGJnQ29sb3IucHVzaCgncmdiYSgyNTUsIDk5LCAxMzIsIDAuMiknKTtcclxuICAgICAgICAgICAgICAgIGJyZENvbG9yLnB1c2goJ3JnYmEoMjU1LCA5OSwgMTMyLCAxKScpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0xpbmUgPSBzaG93TGluZTtcclxuICAgICAgICAgICAgdGhpcy5maWxsID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMudGVuc2lvbiA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gYmdDb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5ib3JkZXJDb2xvciA9IGJyZENvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmJvcmRlcldpZHRoID0gMjtcclxuICAgICAgICAgICAgdGhpcy5wb2ludFJhZGl1cyA9IHNob3dQb2ludCA/IDUgOiAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHNob3dMaW5lOiBib29sZWFuO1xyXG4gICAgICAgIHB1YmxpYyBmaWxsOiBib29sZWFuO1xyXG4gICAgICAgIHB1YmxpYyB0ZW5zaW9uOiBudW1iZXI7XHJcbiAgICAgICAgcHVibGljIGRhdGE6IENoYXJ0UG9pbnRbXTtcclxuICAgICAgICBwdWJsaWMgYmFja2dyb3VuZENvbG9yOiBzdHJpbmdbXTtcclxuICAgICAgICBwdWJsaWMgYm9yZGVyQ29sb3I6IHN0cmluZ1tdO1xyXG4gICAgICAgIHB1YmxpYyBib3JkZXJXaWR0aDogbnVtYmVyO1xyXG4gICAgICAgIHB1YmxpYyBwb2ludFJhZGl1czogbnVtYmVyO1xyXG4gICAgfVxyXG5cclxuICAgIGNsYXNzIFJlZ3Jlc3Npb25TZXJ2aWNlIHtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBFbGVtZW50SURzID0ge1xyXG4gICAgICAgICAgICBZVG9YQ2hhcnQ6IFwiWVRvWENoYXJ0XCIsXHJcbiAgICAgICAgICAgIFhUb1lDaGFydDogXCJYVG9ZQ2hhcnRcIixcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBwcml2YXRlIFVybHMgPSB7XHJcbiAgICAgICAgICAgIExvYWRDaGFydHM6IFwiTG9hZENoYXJ0c1wiLFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgaW5pdGlhbGl6ZSgpIHtcclxuICAgICAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgbGV0IFlUb1hDYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VsZi5FbGVtZW50SURzLllUb1hDaGFydCk7XHJcbiAgICAgICAgICAgIGxldCBYVG9ZQ2FudmFzID0gPEhUTUxDYW52YXNFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlbGYuRWxlbWVudElEcy5YVG9ZQ2hhcnQpO1xyXG5cclxuICAgICAgICAgICAgbGV0IFlUb1hDb250ZXh0ID0gWVRvWENhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIGxldCBYVG9ZQ29udGV4dCA9IFhUb1lDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cclxuICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogc2VsZi5VcmxzLkxvYWRDaGFydHMsXHJcbiAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiAocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YTogQ2hhcnRQb2ludFtdID0gcmVzcG9uc2UuYW5hbHlzaXNEYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjaGFydERhdGE6IENoYXJ0UG9pbnRbXSA9IHJlc3BvbnNlLnl0b1g7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IFlUb1hDaGFydCA9IHNlbGYuaW5pdGlhbGl6ZUNoYXJ0KFlUb1hDb250ZXh0LCBkYXRhLCByZXNwb25zZS55dG9YLCByZXNwb25zZS54TGFiZWwsIHJlc3BvbnNlLnlMYWJlbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxldCByZXZlcnNlZERhdGE6IENoYXJ0UG9pbnRbXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCByZXZlcnNlZENoYXJ0OiBDaGFydFBvaW50W10gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZXJzZWREYXRhLnB1c2goeyB4OiBlLnksIHk6IGUueCwgcjogZS5yLCB0OiBlLnQgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcnREYXRhLmZvckVhY2goKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZXJzZWRDaGFydC5wdXNoKHsgeDogZS55LCB5OiBlLngsIHI6IGUuciwgdDogZS50IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBYVG9ZQ2hhcnQgPSBzZWxmLmluaXRpYWxpemVDaGFydChYVG9ZQ29udGV4dCwgcmV2ZXJzZWREYXRhLCByZXZlcnNlZENoYXJ0LCByZXNwb25zZS55TGFiZWwsIHJlc3BvbnNlLnhMYWJlbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbml0aWFsaXplQ2hhcnQoY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBwb2ludHM6IENoYXJ0UG9pbnRbXSwgcmVzdWx0Q2hhcnQ6IENoYXJ0UG9pbnRbXSwgYXhlc1hMYWJsZTogc3RyaW5nLCBheGVzWUxhYmVsOiBzdHJpbmcpOiBDaGFydCB7XHJcbiAgICAgICAgICAgIGxldCBkYXRhc2V0cyA9IFtdO1xyXG4gICAgICAgICAgICBkYXRhc2V0cy5wdXNoKG5ldyBEYXRhc2V0TW9kZWwocmVzdWx0Q2hhcnQsIHRydWUsIGZhbHNlKSk7XHJcbiAgICAgICAgICAgIGRhdGFzZXRzLnB1c2gobmV3IERhdGFzZXRNb2RlbChwb2ludHMsIGZhbHNlLCB0cnVlKSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgbWluWCA9IDxudW1iZXI+cG9pbnRzWzBdLngsXHJcbiAgICAgICAgICAgICAgICBtaW5ZID0gPG51bWJlcj5wb2ludHNbMF0ueSxcclxuICAgICAgICAgICAgICAgIG1heFggPSA8bnVtYmVyPnBvaW50c1swXS54LFxyXG4gICAgICAgICAgICAgICAgbWF4WSA9IDxudW1iZXI+cG9pbnRzWzBdLnk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHBvaW50c1tpXS54IDwgbWluWCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1pblggPSA8bnVtYmVyPnBvaW50c1tpXS54O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHBvaW50c1tpXS54ID4gbWF4WCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1heFggPSA8bnVtYmVyPnBvaW50c1tpXS54O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHBvaW50c1tpXS55IDwgbWluWSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1pblkgPSA8bnVtYmVyPnBvaW50c1tpXS55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHBvaW50c1tpXS55ID4gbWF4WSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1heFkgPSA8bnVtYmVyPnBvaW50c1tpXS55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgY2hhcnQgPSBuZXcgQ2hhcnQoY29udGV4dCwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ3NjYXR0ZXInLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFzZXRzOiBkYXRhc2V0cyxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzY2FsZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeEF4ZXM6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ2JvdHRvbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyaWRMaW5lczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlja3M6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW46IG1pblggLSAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXg6IG1heFggKyAxMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlTGFiZWw6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsU3RyaW5nOiBheGVzWExhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiAxNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U3R5bGU6ICdib2xkJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeUF4ZXM6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbjogbWluWSAtIDEwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heDogbWF4WSArIDEwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVMYWJlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxTdHJpbmc6IGF4ZXNZTGFiZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IDE2LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTdHlsZTogJ2JvbGQnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGFydDtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBsZXQgcmVncmVzc2lvblJlc3VsdHMgPSBuZXcgUmVncmVzc2lvblNlcnZpY2UoKTtcclxufSJdfQ==